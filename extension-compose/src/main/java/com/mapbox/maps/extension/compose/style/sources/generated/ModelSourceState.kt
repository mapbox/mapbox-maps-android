// This file is generated.

package com.mapbox.maps.extension.compose.style.sources.generated

import androidx.compose.runtime.Composable
import androidx.compose.runtime.MutableState
import androidx.compose.runtime.Stable
import androidx.compose.runtime.getValue
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.runtime.saveable.Saver
import androidx.compose.runtime.saveable.rememberSaveable
import androidx.compose.runtime.setValue
import com.mapbox.bindgen.Value
import com.mapbox.maps.extension.compose.style.ActionWhenNotInitial
import com.mapbox.maps.extension.compose.style.IdGenerator.generateRandomSourceId
import com.mapbox.maps.extension.compose.style.LongValue
import com.mapbox.maps.extension.compose.style.StringListValue
import com.mapbox.maps.extension.compose.style.StringValue
import com.mapbox.maps.extension.compose.style.sources.ModelSourceModelsValue
import com.mapbox.maps.extension.compose.style.sources.SourceState
import java.util.Objects

/**
 * Create and [rememberSaveable] a [ModelSourceState] using [ModelSourceState.Saver].
 * [init] will be called when the [ModelSourceState] is first created to configure its
 * initial state.
 *
 * @param key An optional key to be used as a key for the saved value. If not provided we use the
 * automatically generated by the Compose runtime which is unique for the every exact code location
 * in the composition tree.
 * @param sourceId The optional sourceId for the source state, by default, a random source ID will be used.
 * @param init A function initialise this [ModelSourceState].
 */
@Composable
public inline fun rememberModelSourceState(
  key: String? = null,
  sourceId: String = remember {
    generateRandomSourceId("model")
  },
  crossinline init: ModelSourceState.() -> Unit = {}
): ModelSourceState = rememberSaveable(key = key, saver = ModelSourceState.Saver) {
  ModelSourceState(sourceId).apply(init)
}

/**
 * A collection of 3D models
 *
 * @see [The online documentation](https://docs.mapbox.com/style-spec/reference/sources#model)
 *
 * @param sourceId The id of the source state, by default a random generated ID will be used.
 * @param initialProperties The initial mutable properties of the source.
 */
@Stable
public class ModelSourceState private constructor(
  sourceId: String,
  sourceType: String,
  initialProperties: Map<String, Pair<Boolean, Value>>,
  url: StringValue,
  maxZoom: LongValue,
  minZoom: LongValue,
  tiles: StringListValue,
  models: ModelSourceModelsValue,
) : SourceState(
  sourceId = sourceId,
  sourceType = sourceType,
  initialProperties = initialProperties,
) {
  public constructor(
    sourceId: String = generateRandomSourceId("model"),
  ) : this(
    sourceId = sourceId,
    sourceType = "model",
    initialProperties = emptyMap(),
    url = StringValue.INITIAL,
    maxZoom = LongValue.INITIAL,
    minZoom = LongValue.INITIAL,
    tiles = StringListValue.INITIAL,
    models = ModelSourceModelsValue.INITIAL,
  )

  private val urlState: MutableState<StringValue> = mutableStateOf(url)

  /**
   * A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`. Required if
   * `tiles` is not provided.
   */
  public var url: StringValue by urlState

  private val maxZoomState: MutableState<LongValue> = mutableStateOf(maxZoom)

  /**
   * Maximum zoom level at which to create batched model tiles. Data from tiles at the maxzoom
   * are used when displaying the map at higher zoom levels.
   * Default value: 18.
   */
  public var maxZoom: LongValue by maxZoomState

  private val minZoomState: MutableState<LongValue> = mutableStateOf(minZoom)

  /**
   * Minimum zoom level for which batched-model tiles are available
   * Default value: 0.
   */
  public var minZoom: LongValue by minZoomState

  private val tilesState: MutableState<StringListValue> = mutableStateOf(tiles)

  /**
   * An array of one or more tile source URLs, as in the TileJSON spec. Requires `batched-model`
   * source type.
   */
  public var tiles: StringListValue by tilesState

  private val modelsState: MutableState<ModelSourceModelsValue> = mutableStateOf(models)

  /**
   * Defines properties of 3D models in collection. Requires `model` source type.
   */
  public var models: ModelSourceModelsValue by modelsState

  @Composable
  override fun UpdateProperties() {
    ActionWhenNotInitial(setBuilderPropertyAction, urlState, "url")
    ActionWhenNotInitial(setBuilderPropertyAction, maxZoomState, "maxzoom")
    ActionWhenNotInitial(setBuilderPropertyAction, minZoomState, "minzoom")
    ActionWhenNotInitial(setBuilderPropertyAction, tilesState, "tiles")
    ActionWhenNotInitial(setBuilderPropertyAction, modelsState, "models")
  }

  private fun getProperties(): Map<String, Value> =
    listOfNotNull(
      ("url" to url.value).takeIf { url.isNotInitial() },
      ("maxzoom" to maxZoom.value).takeIf { maxZoom.isNotInitial() },
      ("minzoom" to minZoom.value).takeIf { minZoom.isNotInitial() },
      ("tiles" to tiles.value).takeIf { tiles.isNotInitial() },
      ("models" to models.value).takeIf { models.isNotInitial() },
    ).toMap()

  /**
   * See [Any.equals]
   */
  override fun equals(other: Any?): Boolean {
    if (this === other) return true
    if (javaClass != other?.javaClass) return false

    other as ModelSourceState

    if (sourceId != other.sourceId) return false
    if (url != other.url) return false
    if (maxZoom != other.maxZoom) return false
    if (minZoom != other.minZoom) return false
    if (tiles != other.tiles) return false
    if (models != other.models) return false

    return true
  }

  /**
   * See [Any.hashCode]
   */
  override fun hashCode(): Int {
    return Objects.hash(
      sourceId,
      url,
      maxZoom,
      minZoom,
      tiles,
      models,
    )
  }

  /**
   * Returns a string representation of the object.
   */
  override fun toString(): String =
    "ModelSourceState(sourceId=$sourceId, url=$url, maxZoom=$maxZoom, minZoom=$minZoom, tiles=$tiles, models=$models)"

  /**
   * Public companion object.
   */
  public companion object {
    /**
     * The default saver implementation for [ModelSourceState]
     */
    public val Saver: Saver<ModelSourceState, Holder> = Saver(
      save = { it.save() },
      restore = { holder ->
        ModelSourceState(
          sourceId = holder.sourcedId,
          sourceType = "model",
          initialProperties = holder.savedProperties,
          url = holder.savedProperties["url"]?.let { StringValue(it.second) } ?: StringValue.INITIAL,
          maxZoom = holder.savedProperties["maxzoom"]?.let { LongValue(it.second) } ?: LongValue.INITIAL,
          minZoom = holder.savedProperties["minzoom"]?.let { LongValue(it.second) } ?: LongValue.INITIAL,
          tiles = holder.savedProperties["tiles"]?.let { StringListValue(it.second) } ?: StringListValue.INITIAL,
          models = holder.savedProperties["models"]?.let { ModelSourceModelsValue(it.second) } ?: ModelSourceModelsValue.INITIAL,
        )
      }
    )
  }
}
// End of generated file.